<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>RUINACOIN</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { background:#0f0f0f; color:#fff; font-family:Arial, sans-serif; text-align:center; padding:20px; margin:0; }
#playerId { position:fixed; top:10px; left:10px; background:#1a1a1a; padding:8px 12px; border-radius:8px; color:#00ffd5; font-weight:bold; font-size:16px; box-shadow:0 0 10px #00ffd5; z-index:9999; cursor:pointer; }
h1 { font-size:32px; color:#ff00aa; margin-bottom:10px; text-shadow:0 0 10px #ff00aa; }
#score { font-size:24px; margin-bottom:10px; }
#clickPowerDisplay { font-size:20px; color:#00ffd5; margin-bottom:20px; }
.tap-button { width:80%; max-width:200px; height:auto; cursor:pointer; border-radius:20px; box-shadow:0 0 20px #ff00aa; transition:transform .1s ease; }
.tap-button:active { transform:scale(.97); }
#message { margin-top:20px; font-size:18px; color:#ffcc00; min-height:24px; white-space:pre-line; }
#boostIndicator { position:fixed; top:70px; left:10px; background:#222; color:#ffcc00; padding:6px 10px; border-radius:8px; box-shadow:0 0 8px rgba(0,0,0,.6); font-weight:bold; z-index:9999; display:none; }
#console { display:none; position:fixed; bottom:0; left:0; width:100%; background:#111; color:#0f0; font-family:monospace; max-height:300px; overflow-y:auto; padding:10px; box-sizing:border-box; z-index:9999; }
#consoleOutput { white-space:pre-wrap; margin-bottom:5px; }
#consoleInput { width:100%; padding:5px; font-family:monospace; background:#000; color:#0f0; border:none; outline:none; }
</style>
</head>
<body>

<div id="playerId">ID: ??????</div>
<h1>RUINACOIN TAP</h1>
<div id="score">RUINA: 0</div>
<div id="clickPowerDisplay">Click Power: +1</div>

<img id="tapButton" src="https://i.postimg.cc/BnNsnqwB/photo-5321361869136590759-y-removebg-preview.png" class="tap-button" alt="tap">

<div id="message"></div>
<div id="boostIndicator"></div>

<!-- ÐšÐ¾Ð½ÑÐ¾Ð»ÑŒ -->
<div id="console">
  <div id="consoleOutput"></div>
  <input id="consoleInput" type="text" placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ...">
</div>
<script>
//////////////////////
// GLOBAL VARIABLES //
//////////////////////
let playerID = localStorage.getItem("playerID") || String(Math.floor(100000 + Math.random() * 900000));
localStorage.setItem("playerID", playerID);

let ruina = Number(localStorage.getItem("ruina_"+playerID) || 0);
let baseClick = 1;
let baseAuto = 0;
let totalClicks = 0;
let activeBoostMultiplier = 1;
let boostTimer = null;
let autoInterval = null;

let consoleHistory = [];
let consoleHistoryIndex = -1;

let easterRPressStart = null;
let easterParts = 0;

//////////////////////
// UTILS FUNCTIONS //
//////////////////////
function savePlayer(){
  localStorage.setItem("ruina_"+playerID, ruina);
  localStorage.setItem("ruinaData_"+playerID, JSON.stringify({baseClick,baseAuto,totalClicks,activeBoostMultiplier}));
}

function showMsg(text,duration=3000){
  const m = document.getElementById("message");
  m.innerText = text;
  setTimeout(()=>{ m.innerText=""; },duration);
}

function updateUI(){
  const clickPower = Math.round(baseClick * activeBoostMultiplier);
  document.getElementById("score").innerText = "RUINA: "+Math.round(ruina);
  document.getElementById("clickPowerDisplay").innerText = "Click Power: +"+clickPower;
  document.getElementById("playerId").innerText = "ID: "+playerID;
  renderBoostIndicator();
}

function renderBoostIndicator(){
  const el = document.getElementById("boostIndicator");
  if(activeBoostMultiplier>1){
    el.innerText = "BOOST x"+activeBoostMultiplier;
    el.style.display="block";
  } else el.style.display="none";
}

function scheduleBoostEnd(ms){
  if(boostTimer) clearTimeout(boostTimer);
  boostTimer = setTimeout(()=>{
    activeBoostMultiplier=1;
    updateUI();
    savePlayer();
  }, ms);
}

function effectiveClickPower(){ return baseClick * activeBoostMultiplier; }

function spawnParticles(power){
  const btn=document.getElementById("tapButton");
  const clone=document.createElement("div");
  clone.style.position="fixed";
  clone.style.width="20px";
  clone.style.height="20px";
  clone.style.borderRadius="50%";
  clone.style.background="#ff00aa";
  const rect = btn.getBoundingClientRect();
  clone.style.left = (rect.left + rect.width/2 -10) +"px";
  clone.style.top = (rect.top + rect.height/2 -10) +"px";
  clone.style.opacity="1";
  clone.style.zIndex="9999";
  document.body.appendChild(clone);
  let dx = (Math.random()*100-50);
  let dy = -Math.random()*150-50;
  clone.style.transition = "all 0.7s linear";
  setTimeout(()=>{
    clone.style.transform = `translate(${dx}px,${dy}px) scale(0.3)`;
    clone.style.opacity="0";
    setTimeout(()=>clone.remove(),700);
  },10);
}

//////////////////////
// CLICK HANDLING //
//////////////////////
function clickHandler(){
  totalClicks++;
  const power = effectiveClickPower();
  ruina += power;
  spawnParticles(power);
  updateUI();
  savePlayer();
}

document.getElementById("tapButton").addEventListener("click", clickHandler);

//////////////////////
// AUTOCLICK //
//////////////////////
function startAutoClick(){
  if(autoInterval) clearInterval(autoInterval);
  autoInterval = setInterval(()=>{
    ruina += baseAuto * activeBoostMultiplier;
    updateUI();
    savePlayer();
  },1000);
}

if(baseAuto>0) startAutoClick();

//////////////////////
// CASES LOGIC //
//////////////////////
const cases = [
  {type:"ruina",amount:[1000,5000]},
  {type:"ruina",amount:[5000,20000]},
  {type:"boost",multiplier:2,duration:120},
  {type:"boost",multiplier:3,duration:60}
];

function openCase(num=1){
  for(let i=0;i<num;i++){
    const c = cases[Math.floor(Math.random()*cases.length)];
    if(c.type==="ruina"){
      const amount = Math.floor(Math.random()*(c.amount[1]-c.amount[0])+c.amount[0]);
      ruina += amount;
      showMsg("ðŸŽ You got "+amount+" RUINA!");
    } else if(c.type==="boost"){
      activeBoostMultiplier = c.multiplier;
      scheduleBoostEnd(c.duration*1000);
      showMsg("âš¡ Boost x"+c.multiplier+" for "+c.duration+"s");
    }
  }
  updateUI();
  savePlayer();
}

//////////////////////
// CONSOLE COMMANDS //
//////////////////////
const consoleEl = document.getElementById("console");
const consoleOutput = document.getElementById("consoleOutput");
const consoleInput = document.getElementById("consoleInput");

document.getElementById("playerId").addEventListener("dblclick",()=>{ 
  consoleEl.style.display = consoleEl.style.display==="none"?"block":"none"; 
});

consoleInput.addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    const cmd = e.target.value.trim();
    if(cmd){ 
      consoleHistory.push(cmd);
      consoleHistoryIndex = consoleHistory.length;
      handleCommand(cmd);
      consoleOutput.innerText = cmd + "\n" + consoleOutput.innerText; 
    }
    e.target.value="";
  } else if(e.key==="ArrowUp"){
    if(consoleHistoryIndex>0){
      consoleHistoryIndex--;
      consoleInput.value = consoleHistory[consoleHistoryIndex];
    }
  } else if(e.key==="ArrowDown"){
    if(consoleHistoryIndex<consoleHistory.length-1){
      consoleHistoryIndex++;
      consoleInput.value = consoleHistory[consoleHistoryIndex];
    } else {
      consoleInput.value="";
    }
  }
});

function getPlayerData(id){
  const data = JSON.parse(localStorage.getItem("ruinaData_"+id)||"{}");
  return data || {baseClick:1, baseAuto:0, totalClicks:0, activeBoostMultiplier:1};
}

function setPlayerData(id,data){
  localStorage.setItem("ruinaData_"+id, JSON.stringify(data));
  if(id===playerID){
    baseClick = data.baseClick; baseAuto = data.baseAuto;
    totalClicks = data.totalClicks; activeBoostMultiplier = data.activeBoostMultiplier;
    if(baseAuto>0) startAutoClick();
    updateUI();
  }
}

function handleCommand(cmd){
  const parts = cmd.split(" ");
  const command = parts[0];
  function log(msg){ consoleOutput.innerText += msg + "\n"; consoleOutput.scrollTop = consoleOutput.scrollHeight; }

  if(command==="/pay" && parts.length===3){
    const id = parts[1], sum = parseInt(parts[2]);
    if(!isNaN(sum)){
      const bal = Number(localStorage.getItem("ruina_"+id) || 0);
      localStorage.setItem("ruina_"+id, bal+sum);
      if(id===playerID){ ruina += sum; updateUI(); }
      log(`Added ${sum} RUINA to ${id}`);
      showMsg(`Added ${sum} RUINA to ${id}`);
    }
  }
  else if(command==="/balance" && parts.length===3){
    const id = parts[1], amount = parseInt(parts[2]);
    if(!isNaN(amount)){
      localStorage.setItem("ruina_"+id, amount);
      if(id===playerID){ ruina = amount; updateUI(); }
      log(`Set balance of ${id} = ${amount}`);
    }
  }
  else if(command==="/click" && parts.length===3){
    const id = parts[1], val = parseInt(parts[2]);
    if(!isNaN(val)){
      const data = getPlayerData(id); data.baseClick = val; setPlayerData(id,data);
      log(`Set ClickPower of ${id} = ${val}`);
      showMsg(`Set ClickPower of ${id} = ${val}`);
    }
  }
  else if(command==="/autoclick" && parts.length===3){
    const id = parts[1], val = parseInt(parts[2]);
    if(!isNaN(val)){
      const data = getPlayerData(id); data.baseAuto = val; setPlayerData(id,data);
      log(`Set AutoClick of ${id} = ${val}`);
      showMsg(`Set AutoClick of ${id} = ${val}`);
    }
  }
  else if(command==="/boost" && parts.length===4){
    const id = parts[1], mult = parseFloat(parts[2]), dur = parseInt(parts[3]);
    if(!isNaN(mult) && !isNaN(dur)){
      const data = getPlayerData(id);
      data.activeBoostMultiplier = mult;
      setPlayerData(id,data);
      if(id===playerID) scheduleBoostEnd(dur*1000);
      log(`Applied boost x${mult} to ${id} for ${dur}s`);
      showMsg(`Applied boost x${mult} to ${id} for ${dur}s`);
    }
  }
  else if(command==="/case" && parts.length>=2){
    const id = parts[1], num = parts[2]?parseInt(parts[2]):1;
    if(!isNaN(num)){
      if(id===playerID){ openCase(num); }
      else{
        const data = getPlayerData(id);
        for(let i=0;i<num;i++){
          const c = cases[Math.floor(Math.random()*cases.length)];
          if(c.type==="ruina"){
            const amt = Math.floor(Math.random()*(c.amount[1]-c.amount[0])+c.amount[0]);
            const old = Number(localStorage.getItem("ruina_"+id)||0);
            localStorage.setItem("ruina_"+id, old+amt);
          } else if(c.type==="boost"){
            data.activeBoostMultiplier = c.multiplier;
          }
        }
        setPlayerData(id,data);
      }
      log(`Opened ${num} cases for ${id}`);
    }
  }
  else log("Unknown command");
}

//////////////////////
// PASCHALKA & KEYS //
//////////////////////
document.addEventListener("keydown",e=>{
  if(e.code==="Space") clickHandler();
  if(e.key==="r" || e.key==="R") {
    if(easterRPressStart===null) easterRPressStart = Date.now();
  }
});
document.addEventListener("keyup",e=>{
  if(e.key==="r" || e.key==="R") {
    if(easterRPressStart && Date.now()-easterRPressStart>=2000){
      easterParts++;
      showMsg(`Easter progress: part ${easterParts}/4`);
      if(easterParts>=4){
        showMsg("ðŸ”¥ RUINACOIN LOGO UNLOCKED! ðŸ”¥",5000);
      }
    }
    easterRPressStart=null;
  }
});

//////////////////////
// INIT UI //
//////////////////////
document.getElementById("playerId").innerText="ID: "+playerID;
updateUI();
</script>
</body>
</html>
